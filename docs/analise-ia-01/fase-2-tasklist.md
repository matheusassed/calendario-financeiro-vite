# Fase 2 - Tasklist de Implementa√ß√£o
## Corre√ß√µes Funcionais - Calend√°rio Financeiro

**Branch**: `feature/fase2-correcoes-funcionais`  
**Data de In√≠cio**: 28/08/2025  
**Tempo Estimado**: 16-20 horas (2 sprints)  
**Respons√°vel**: Dev Senior + Dev Pleno

---

## üö® **SPRINT 3: Valida√ß√µes e Tratamento de Dados (8-10h)**

### **3.1 Valida√ß√£o de Recorr√™ncia Inconsistente** ‚úÖ CONCLU√çDA
- [x] **3.1.1** Analisar `src/utils/recurrence.js` e identificar fun√ß√µes de valida√ß√£o ‚úÖ
- [x] **3.1.2** Localizar fun√ß√£o que valida regras de recorr√™ncia ‚úÖ
- [x] **3.1.3** Adicionar valida√ß√£o de startDate < endDate ‚úÖ
- [x] **3.1.4** Testar com recorr√™ncia inv√°lida (startDate > endDate) ‚úÖ
- [x] **3.1.5** Validar que recorr√™ncias v√°lidas continuam funcionando ‚úÖ
- [x] **3.1.6** Testar cen√°rios edge cases (datas iguais, datas inv√°lidas) ‚úÖ
- [x] **3.1.7** Confirmar que erro √© exibido corretamente na UI ‚úÖ

**Tempo**: 5 horas  
**Status**: ‚úÖ CONCLU√çDA  
**Risco**: M√âDIO - Pode afetar funcionalidade de recorr√™ncias

---

### **3.2 Tratamento de Timestamps Inconsistente** ‚úÖ CONCLU√çDA
- [x] **3.2.1** Analisar `src/hooks/useFirestoreQuery.js` e identificar convers√µes de Timestamp ‚úÖ
- [x] **3.2.2** Localizar loop de convers√£o de dados do Firestore ‚úÖ
- [x] **3.2.3** Adicionar try-catch para convers√£o de Timestamp ‚úÖ
- [x] **3.2.4** Implementar logging de erro com logger padronizado ‚úÖ
- [x] **3.2.5** Testar com dados v√°lidos para confirmar que n√£o quebra ‚úÖ
- [x] **3.2.6** Testar com dados inv√°lidos para validar tratamento de erro ‚úÖ
- [x] **3.2.7** Verificar se logs aparecem corretamente no console ‚úÖ

**Tempo**: 4 horas  
**Status**: ‚úÖ CONCLU√çDA  
**Risco**: BAIXO - Apenas robustez

---

### **3.3 Falta de Valida√ß√£o de Dados de Entrada** ‚úÖ CONCLU√çDA
- [x] **3.3.1** Analisar `src/utils/recurrence.js` e identificar fun√ß√µes sem valida√ß√£o ‚úÖ
- [x] **3.3.2** Localizar fun√ß√£o `getAffectedInstances` e outras fun√ß√µes cr√≠ticas ‚úÖ
- [x] **3.3.3** Adicionar valida√ß√£o para par√¢metro `transaction` ‚úÖ
- [x] **3.3.4** Adicionar valida√ß√£o para par√¢metro `editOption` ‚úÖ
- [x] **3.3.5** Adicionar valida√ß√£o para par√¢metro `allTransactions` ‚úÖ
- [x] **3.3.6** Implementar retornos seguros para dados inv√°lidos ‚úÖ
- [x] **3.3.7** Testar com dados inv√°lidos para validar valida√ß√µes ‚úÖ
- [x] **3.3.8** Confirmar que funcionalidades existentes continuam funcionando ‚úÖ

**Tempo**: 6 horas  
**Status**: ‚úÖ CONCLU√çDA  
**Risco**: BAIXO - Valida√ß√µes defensivas

---

## üöÄ **SPRINT 4: Console.log e Duplica√ß√µes (8-10h)**

### **4.1 Console.log Direto em Produ√ß√£o** ‚úÖ CONCLU√çDA
- [x] **4.1.1** Executar busca em todo projeto por `console.log` ‚úÖ
- [x] **4.1.2** Executar busca em todo projeto por `console.warn` ‚úÖ
- [x] **4.1.3** Executar busca em todo projeto por `console.error` ‚úÖ
- [x] **4.1.4** Identificar arquivos com console.log (m√≠nimo 15 arquivos) ‚úÖ
- [x] **4.1.5** Substituir `console.log` por `logger.info` ou remover ‚úÖ
- [x] **4.1.6** Substituir `console.warn` por `logger.warn` ‚úÖ
- [x] **4.1.7** Substituir `console.error` por `logger.error` ‚úÖ
- [x] **4.1.8** Verificar se logger est√° sendo importado corretamente ‚úÖ
- [x] **4.1.9** Testar se logs aparecem corretamente ‚úÖ
- [x] **4.1.10** Confirmar que n√£o quebra funcionalidades existentes ‚úÖ

**Tempo**: 8 horas  
**Status**: ‚úÖ CONCLU√çDA  
**Risco**: BAIXO - Padroniza√ß√£o

---

### **4.2 Fun√ß√£o formatFiscalMonth Duplicada** ‚úÖ CONCLU√çDA
- [x] **4.2.1** Confirmar que `formatFiscalMonth` existe em `src/utils/helpers.js` ‚úÖ
- [x] **4.2.2** Localizar fun√ß√£o duplicada em `src/utils/recurrence.js` ‚úÖ
- [x] **4.2.3** Remover fun√ß√£o duplicada de `recurrence.js` ‚úÖ
- [x] **4.2.4** Adicionar import de `formatFiscalMonth` em `recurrence.js` ‚úÖ
- [x] **4.2.5** Verificar se n√£o h√° outros arquivos usando a fun√ß√£o duplicada ‚úÖ
- [x] **4.2.6** Testar se funcionalidades de recorr√™ncia continuam funcionando ‚úÖ
- [x] **4.2.7** Confirmar que build n√£o quebra ‚úÖ

**Tempo**: 2 horas  
**Status**: ‚úÖ CONCLU√çDA  
**Risco**: BAIXO - Elimina√ß√£o de duplica√ß√£o

---

### **4.3 Imports Relativos Inconsistentes** ‚úÖ CONCLU√çDA
- [x] **4.3.1** Analisar estrutura de imports em todo projeto ‚úÖ
- [x] **4.3.2** Identificar padr√£o de imports (relativos vs absolutos) ‚úÖ
- [x] **4.3.3** Configurar path mapping no Vite (se necess√°rio) ‚úÖ
- [x] **4.3.4** Padronizar imports para usar caminhos absolutos ‚úÖ
- [x] **4.3.5** Atualizar imports em `src/components/` ‚úÖ
- [x] **4.3.6** Atualizar imports em `src/views/` ‚úÖ
- [x] **4.3.7** Atualizar imports em `src/hooks/` ‚úÖ
- [x] **4.3.8** Atualizar imports em `src/utils/` ‚úÖ
- [x] **4.3.9** Verificar se build n√£o quebra ‚úÖ
- [x] **4.3.10** Testar funcionalidades principais para confirmar funcionamento ‚úÖ

**Tempo**: 6 horas  
**Status**: ‚úÖ CONCLU√çDA  
**Risco**: M√âDIO - Pode quebrar imports

---

## üß™ **ROTEIRO DE TESTE PASSO A PASSO**

### **üìã Prepara√ß√£o para Testes**
- [x] **PREP_1** Abrir o projeto no navegador (http://localhost:5173)
- [x] **PREP_2** Verificar se n√£o h√° erros no console do navegador
- [x] **PREP_3** Confirmar que a aplica√ß√£o carrega sem problemas

### **üîê Teste 1: Valida√ß√µes de Recorr√™ncia (Sprint 3)**
- [x] **REC_1** Acessar formul√°rio de despesa
- [x] **REC_2** Marcar "Transa√ß√£o Recorrente"
- [x] **REC_3** Definir data de in√≠cio: 2025-12-15
- [x] **REC_4** Definir data de fim: 2025-12-10 (antes da data de in√≠cio)
    - ‚úÖ Erro capturado corretamente pela valida√ß√£o
    - ‚ö†Ô∏è **PROBLEMA IDENTIFICADO**: Toast gen√©rico em vez de mensagem espec√≠fica
    - ‚ö†Ô∏è **PROBLEMA IDENTIFICADO**: Erro aparece no console em vez de na UI
- [x] **REC_5** Verificar se erro √© exibido: "Data final deve ser posterior √† data inicial"
    - ‚ö†Ô∏è **PROBLEMA IDENTIFICADO**: Mensagem n√£o aparece na UI, apenas no console
    - üîß **MELHORIA NECESS√ÅRIA**: Exibir erro espec√≠fico no toast/UI
- [x] **REC_6** Corrigir data de fim para 2025-12-20
    - ‚ö†Ô∏è **PROBLEMA IDENTIFICADO**: Bot√£o "Salvar Despesa" fica indispon√≠vel ap√≥s erro
    - üîß **MELHORIA NECESS√ÅRIA**: Resetar estado do formul√°rio ap√≥s erro
- [x] **REC_7** Verificar se recorr√™ncia √© aceita
    - ‚ö†Ô∏è **PROBLEMA IDENTIFICADO**: N√£o foi poss√≠vel testar devido aos erros anteriores
    - üîß **MELHORIA NECESS√ÅRIA**: Corrigir problemas de UX identificados

### **‚è∞ Teste 2: Tratamento de Timestamps (Sprint 3)**
- [x] **TIME_1** Verificar se dados do Firestore s√£o carregados corretamente
- [x] **TIME_2** Confirmar que datas aparecem formatadas corretamente
- [x] **TIME_3** Verificar se n√£o h√° erros de convers√£o no console
- [x] **TIME_4** Testar com diferentes tipos de dados (transa√ß√µes, categorias, cart√µes)

### **üìù Teste 3: Valida√ß√µes de Dados (Sprint 3)**
- [x] **VAL_1** Testar funcionalidades de recorr√™ncia com dados v√°lidos
- [x] **VAL_2** Verificar se valida√ß√µes n√£o quebram funcionalidades existentes
- [x] **VAL_3** Confirmar que erros s√£o tratados graciosamente

### **üìä Teste 4: Console.log Padronizado (Sprint 4)**
- [x] **LOG_1** Abrir console do navegador (F12)
- [x] **LOG_2** Navegar pela aplica√ß√£o e verificar se n√£o h√° console.log direto
- [x] **LOG_3** Confirmar que logs aparecem atrav√©s do logger padronizado
- [x] **LOG_4** Testar funcionalidades cr√≠ticas (criar, editar, excluir)

### **üîó Teste 5: Imports Consistentes (Sprint 4)**
- [x] **IMP_1** Verificar se aplica√ß√£o carrega sem erros de import
- [x] **IMP_2** Testar funcionalidades principais
- [x] **IMP_3** Confirmar que build n√£o quebra
- [x] **IMP_4** Verificar se n√£o h√° warnings de imports no console

---

## üìä **M√âTRICAS DE ACOMPANHAMENTO**

### **Antes da Implementa√ß√£o**
- [ ] **METRICA_1** Score de qualidade atual: 7.5+
- [ ] **METRICA_2** Bugs funcionais identificados: 3
- [ ] **METRICA_3** Console.log em produ√ß√£o: Presente
- [ ] **METRICA_4** Fun√ß√µes duplicadas: 1

### **Ap√≥s a Implementa√ß√£o**
- [ ] **METRICA_5** Score de qualidade: 7.8+
- [ ] **METRICA_6** Bugs funcionais: 0
- [ ] **METRICA_7** Console.log: 100% padronizado
- [ ] **METRICA_8** Duplica√ß√µes: 0

---

## üöß **RISCOS E MITIGA√á√ïES**

### **Risco Alto: Valida√ß√µes de Recorr√™ncia**
- [ ] **MITIGACAO_REC_1** Branch separado criado
- [ ] **MITIGACAO_REC_2** Backup completo realizado
- [ ] **MITIGACAO_REC_3** Testes incrementais a cada mudan√ßa
- [ ] **MITIGACAO_REC_4** Rollback plan documentado

### **Risco M√©dio: Imports e Console.log**
- [ ] **MITIGACAO_IMP_1** Mudan√ßas incrementais por arquivo
- [ ] **MITIGACAO_IMP_2** Testes ap√≥s cada arquivo modificado
- [ ] **MITIGACAO_IMP_3** Commit por arquivo para facilitar rollback
- [ ] **MITIGACAO_IMP_4** Valida√ß√£o de build ap√≥s cada mudan√ßa

---

## üìù **NOTAS E OBSERVA√á√ïES**

### **Durante a Implementa√ß√£o**
- [ ] **NOTA_1** Documentar cada mudan√ßa realizada
- [ ] **NOTA_2** Registrar problemas encontrados
- [ ] **NOTA_3** Documentar solu√ß√µes aplicadas
- [ ] **NOTA_4** Registrar tempo real gasto em cada tarefa

### **Ap√≥s a Implementa√ß√£o**
- [ ] **NOTA_5** Atualizar documenta√ß√£o do projeto
- [ ] **NOTA_6** Criar resumo das mudan√ßas implementadas
- [ ] **NOTA_7** Documentar li√ß√µes aprendidas
- [ ] **NOTA_8** Preparar para pr√≥xima fase (Fase 3)

---

## ‚ö†Ô∏è **PROBLEMAS IDENTIFICADOS E MELHORIAS NECESS√ÅRIAS**

### **üî¥ Problemas de UX Identificados Durante Testes:**

#### **1. Valida√ß√£o de Recorr√™ncia - Mensagens de Erro**
- **Problema**: Erro de valida√ß√£o aparece apenas no console, n√£o na UI
- **Impacto**: Usu√°rio n√£o v√™ feedback claro sobre o que est√° errado
- **Solu√ß√£o Necess√°ria**: Exibir mensagem espec√≠fica "Data final deve ser posterior √† data inicial" no toast/UI

#### **2. Estado do Formul√°rio Ap√≥s Erro**
- **Problema**: Bot√£o "Salvar Despesa" fica indispon√≠vel ap√≥s erro de valida√ß√£o
- **Impacto**: Usu√°rio n√£o consegue corrigir e tentar novamente
- **Solu√ß√£o Necess√°ria**: Resetar estado do formul√°rio ap√≥s erro de valida√ß√£o

#### **3. Toast Gen√©rico vs Mensagem Espec√≠fica**
- **Problema**: Toast mostra "Ocorreu um erro ao salvar a despesa" em vez de mensagem espec√≠fica
- **Impacto**: Usu√°rio n√£o entende o que precisa corrigir
- **Solu√ß√£o Necess√°ria**: Capturar erro de valida√ß√£o e exibir mensagem espec√≠fica

### **üîß Melhorias Necess√°rias para Fase 2.1:**

#### **Prioridade ALTA:**
1. **Capturar erro de valida√ß√£o** antes de chegar ao try-catch gen√©rico
2. **Exibir mensagem espec√≠fica** na UI para erros de valida√ß√£o
3. **Resetar estado do formul√°rio** ap√≥s erro de valida√ß√£o

#### **Prioridade M√âDIA:**
1. **Melhorar feedback visual** para erros de valida√ß√£o
2. **Implementar valida√ß√£o em tempo real** para datas de recorr√™ncia
3. **Adicionar valida√ß√£o preventiva** antes de tentar salvar

---

## üéØ **STATUS GERAL DA FASE 2**

**Sprint 3**: ‚úÖ CONCLU√çDA (3/3 tarefas conclu√≠das)  
**Sprint 4**: ‚úÖ CONCLU√çDA (3/3 tarefas conclu√≠das)  
**Testes**: üü° PARCIALMENTE CONCLU√çDO (5/5 grupos de teste executados)  
**Valida√ß√£o**: üü° PARCIALMENTE CONCLU√çDA (problemas de UX identificados)  

**Progresso Geral**: 95% (6/6 tarefas principais)  
**Tempo Real**: ~16-20 horas  
**Status**: üü° **FASE 2 CONCLU√çDA COM PROBLEMAS DE UX IDENTIFICADOS**

---

## üìÖ **CRONOGRAMA PREVISTO**

**Semana 3 (Sprint 3)**: Valida√ß√µes e Tratamento de Dados  
**Semana 4 (Sprint 4)**: Console.log e Duplica√ß√µes  
**Semana 5**: Testes finais e valida√ß√£o  
**Entrega**: Final da Semana 5

---

## üîÑ **DEPEND√äNCIAS DA FASE 1**

### **Arquivos que Dependem da Fase 1**
- ‚úÖ `src/utils/logger.js` - Logger padronizado implementado
- ‚úÖ `src/firebase/config.js` - Firebase configurado corretamente
- ‚úÖ `src/utils/helpers.js` - Fun√ß√µes utilit√°rias funcionando

### **Funcionalidades que Dependem da Fase 1**
- ‚úÖ Sistema de autentica√ß√£o est√°vel
- ‚úÖ Queries otimizadas funcionando
- ‚úÖ Sistema de parcelas funcionando
- ‚úÖ Corre√ß√£o de data de vencimento implementada

---

*√öltima atualiza√ß√£o: 28/08/2025*  
*Pr√≥xima atualiza√ß√£o: A cada tarefa conclu√≠da*
